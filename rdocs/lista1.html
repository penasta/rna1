<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bruno Gondim Toledo">
<meta name="dcterms.date" content="2025-09-30">

<title>Lista 1 — Otimização em RNA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="lista1_files/libs/clipboard/clipboard.min.js"></script>
<script src="lista1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="lista1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="lista1_files/libs/quarto-html/popper.min.js"></script>
<script src="lista1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lista1_files/libs/quarto-html/anchor.min.js"></script>
<link href="lista1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lista1_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lista1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lista1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lista1_files/libs/bootstrap/bootstrap-f5ea73e2307879bd6f4812a942cbea8a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="lista1_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="lista1_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="lista1_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="lista1_files/libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="lista1_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="lista1_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="lista1_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="lista1_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="lista1_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="lista1_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#exercício-1" id="toc-exercício-1" class="nav-link active" data-scroll-target="#exercício-1">Exercício 1</a></li>
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">a)</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">b)</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">c)</a></li>
  <li><a href="#d" id="toc-d" class="nav-link" data-scroll-target="#d">d)</a></li>
  <li><a href="#e" id="toc-e" class="nav-link" data-scroll-target="#e">e)</a>
  <ul class="collapse">
  <li><a href="#learning-rate-1" id="toc-learning-rate-1" class="nav-link" data-scroll-target="#learning-rate-1">Learning rate = 1</a></li>
  <li><a href="#learning-rate-0.1" id="toc-learning-rate-0.1" class="nav-link" data-scroll-target="#learning-rate-0.1">Learning rate = 0.1</a></li>
  <li><a href="#learning-rate-0.01" id="toc-learning-rate-0.01" class="nav-link" data-scroll-target="#learning-rate-0.01">Learning rate = 0.01</a></li>
  <li><a href="#learning-rate-0.001" id="toc-learning-rate-0.001" class="nav-link" data-scroll-target="#learning-rate-0.001">Learning rate = 0.001</a></li>
  <li><a href="#learning-rate-0.0001" id="toc-learning-rate-0.0001" class="nav-link" data-scroll-target="#learning-rate-0.0001">Learning rate = 0.0001</a></li>
  </ul></li>
  <li><a href="#f" id="toc-f" class="nav-link" data-scroll-target="#f">f)</a></li>
  <li><a href="#g" id="toc-g" class="nav-link" data-scroll-target="#g">g)</a></li>
  <li><a href="#h" id="toc-h" class="nav-link" data-scroll-target="#h">h)</a></li>
  <li><a href="#i" id="toc-i" class="nav-link" data-scroll-target="#i">i)</a></li>
  <li><a href="#j" id="toc-j" class="nav-link" data-scroll-target="#j">j)</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lista 1 — Otimização em RNA</h1>
<p class="subtitle lead">Redes Neurais Profundas | Prof.&nbsp;Dr.&nbsp;Guilherme Souza Rodrigues</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://penasta.github.io">Bruno Gondim Toledo</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Universidade de Brasília (UnB)
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 30, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div style="page-break-after: always;"></div>
<section id="exercício-1" class="level1">
<h1>Exercício 1</h1>
<p>Considere a função</p>
<p><span class="math display">\[f(x_1,x_2)= x_1^4+x_2^4+x_1^2x_2+x_1x_2^2-20x_1^2-15x_2^2\]</span> para responder os itens a seguir.</p>
</section>
<section id="a" class="level1">
<h1>a)</h1>
<p>Apresente um gráfico com as curvas de nível de <span class="math inline">\(f(x_1,x_2)\)</span>. Quantos pontos críticos a função parece ter? Dica para usuários do R: use a função <code>geom_contour_filled()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x1<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> x2<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> x2 <span class="sc">+</span> x1 <span class="sc">*</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">20</span> <span class="sc">*</span> x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">15</span> <span class="sc">*</span> x2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>fx <span class="ot">&lt;-</span> <span class="fu">mapply</span>(fx, grid<span class="sc">$</span>x1, grid<span class="sc">$</span>x2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grid, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> fx)) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Observando o gráfico de contorno, considerando valores <span class="math inline">\(-5 &lt; x_1,x_2 &lt; 5\)</span>, a função aparenta ter diversos valores críticos, sendo três mínimos locais, um mínimo global — próximo do valor <span class="math inline">\(x_1 = -3.5, x_2 = -3.2\)</span> —, além de diversos pontos de sela entre os mínimos locais e global.</p>
</section>
<section id="b" class="level1">
<h1>b)</h1>
<p>Encontre (algebricamente) o gradiente de f em relação ao vetor x = (x1, x2). Isso é, <span class="math display">\[\nabla_xf(\mathbf{x})= \left( \frac{\partial f}{\partial x_1},\frac{\partial f}{\partial x_2} \right). \]</span></p>
<p>Seja</p>
<p><span class="math display">\[
f(x_1,x_2)= x_1^4+x_2^4+x_1^2x_2+x_1x_2^2-20x_1^2-15x_2^2,
\]</span> e</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\frac{\partial f}{\partial x_1} &amp; = 4x_1^3 + 2x_1x_2 + x_2^2 - 40x_1, \\
\frac{\partial f}{\partial x_2} &amp; = 4x_2^3+2x_1x_2+x_1^2-30x_2.
\end{split}
\end{equation}\]</span></p>
<p>Então,</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\nabla_xf(\mathbf{x}) &amp; = \left( \frac{\partial f}{\partial x_1},\frac{\partial f}{\partial x_2} \right) \\
&amp; = \left( 4x_1^3 + 2x_1x_2 + x_2^2 - 40x_1, 4x_2^3+2x_1x_2+x_1^2-30x_2 \right).
\end{split}
\end{equation}\]</span></p>
</section>
<section id="c" class="level1">
<h1>c)</h1>
<p>Crie uma função computacional que implemente o método do gradiente para minimizar a função em estudo. Permita ao usuário definir a taxa de aprendizado, o número de passos e o ponto de partida.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gradiente <span class="ot">&lt;-</span> <span class="cf">function</span>(learning_rate, n_steps, x1, x2) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="fu">numeric</span>(),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">numeric</span>())</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  init <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="dv">0</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> x1,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> x2,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">fx</span>(x1,x2))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,init)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_steps){</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    dpx1 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x1 <span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x2 <span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">40</span> <span class="sc">*</span> x1)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    dpx2 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x2 <span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x1 <span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">30</span> <span class="sc">*</span> x2)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x1 <span class="sc">-</span> dpx1 <span class="sc">*</span> learning_rate</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> x2 <span class="sc">-</span> dpx2 <span class="sc">*</span> learning_rate</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    fx <span class="ot">&lt;-</span> <span class="fu">fx</span>(x1,x2)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.finite</span>(fx) <span class="sc">||</span> <span class="fu">abs</span>(fx <span class="sc">-</span> df<span class="sc">$</span>fx[i]) <span class="sc">&lt;</span> <span class="fl">10e-6</span>){</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> i,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> x1,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> x2,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">fx</span>(x1,x2))</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,result)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> fx)) <span class="sc">+</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2), <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(p,df))</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">gradiente</span>(<span class="fl">0.01</span>,<span class="dv">100</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>resultados[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(resultados[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8c3b051ba50973417eb6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8c3b051ba50973417eb6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[0,1,2,3,4,5],[-3,-3.39,-3.49265424,-3.506253340625985,-3.509839861608084,-3.51062704499338],[-3,-3.09,-3.16127784,-3.188760878273614,-3.19498151978859,-3.196380246615873],[-207,-217.70757198,-218.6653128187177,-218.7234539862638,-218.7266099242889,-218.726767217307]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
<p>Além do solicitado no enunciado, adicionei também um critério de parada, seja por convergência ou por divergência, evitando custo computacional desnecessário. O usuário define o número máximo de iterações, porém se o gradiente convergir ou divergir antes deste máximo, a função irá retornar os passos antes do final do loop.</p>
</section>
<section id="d" class="level1">
<h1>d)</h1>
<p>Use a função criada no item c) para encontrar o valor obtido pelo método do gradiente partindo-se do ponto inicial <span class="math inline">\((x_1^{(0)},x_2^{(0)})=(0,5)\)</span>. Use taxa de aprendizado igual a 0.01 e execute 100 passos.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente</span>(<span class="fl">0.01</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">gradiente</span>(<span class="fl">0.01</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e1dfefcc7e25a08f8266" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e1dfefcc7e25a08f8266">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],[0,-0.25,-0.364375,-0.5281052608691407,-0.7566006193211143,-1.063484835116856,-1.45315815031718,-1.906673083724944,-2.363531490518044,-2.727107939359158,-2.93245725152569,-3.010815784400344,-3.032984343643287,-3.038453031573758,-3.039746644835714],[5,1.5,1.821875,2.138497944580078,2.408656534897441,2.60301186659562,2.722484642010709,2.790083542768069,2.828366527995239,2.849673834155819,2.859985047493944,2.863991620842937,2.865328319604505,2.865760781249973,2.865904494399218],[250,-30.40234375,-42.37646007553925,-55.00250743807925,-67.4974159015635,-81.3280027933879,-99.03818066927846,-120.3604643609796,-139.6268194433848,-150.2489438695818,-153.2185063765043,-153.6163060628093,-153.6471243693893,-153.6489868732098,-153.6490915222967]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
</section>
<section id="e" class="level1">
<h1>e)</h1>
<p>Repita o item d), agora com as seguintes taxas de aprendizado: 1, 0.1, 0.01, 0.001, 0.0001. Qual dessas opções lhe parece mais apropriada nesse caso? Justifique sua resposta.</p>
<section id="learning-rate-1" class="level2">
<h2 class="anchored" data-anchor-id="learning-rate-1">Learning rate = 1</h2>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">gradiente</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-774ebbcdd348f866185c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-774ebbcdd348f866185c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],[0,1,2,3,4],[0,-25,-74800,-2.52715519203037e+16,-2.49326014834507e+50],[5,-345,164225930,-1.771679586077537e+25,2.224413563985979e+76],[250,14162352125,7.273893192130194e+32,9.852370255769846e+100,2.44828594035156e+305]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
</section>
<section id="learning-rate-0.1" class="level2">
<h2 class="anchored" data-anchor-id="learning-rate-0.1">Learning rate = 0.1</h2>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">gradiente</span>(<span class="fl">0.1</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cdea0729550038fae7fe" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cdea0729550038fae7fe">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],[0,1,2,3,4],[0,-2.5,-111.25,-10585406.2890625,-2.306254648815591e+22],[5,-30,10664.375,-485138751478.1836,4.567282658546349e+34],[250,793976.5625,1.293424728909667e+16,5.539414516537838e+46,4.351425572462128e+138]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
</section>
<section id="learning-rate-0.01" class="level2">
<h2 class="anchored" data-anchor-id="learning-rate-0.01">Learning rate = 0.01</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente</span>(<span class="fl">0.01</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">gradiente</span>(<span class="fl">0.01</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-edf4882386a1332d577c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-edf4882386a1332d577c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],[0,-0.25,-0.364375,-0.5281052608691407,-0.7566006193211143,-1.063484835116856,-1.45315815031718,-1.906673083724944,-2.363531490518044,-2.727107939359158,-2.93245725152569,-3.010815784400344,-3.032984343643287,-3.038453031573758,-3.039746644835714],[5,1.5,1.821875,2.138497944580078,2.408656534897441,2.60301186659562,2.722484642010709,2.790083542768069,2.828366527995239,2.849673834155819,2.859985047493944,2.863991620842937,2.865328319604505,2.865760781249973,2.865904494399218],[250,-30.40234375,-42.37646007553925,-55.00250743807925,-67.4974159015635,-81.3280027933879,-99.03818066927846,-120.3604643609796,-139.6268194433848,-150.2489438695818,-153.2185063765043,-153.6163060628093,-153.6471243693893,-153.6489868732098,-153.6490915222967]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
</section>
<section id="learning-rate-0.001" class="level2">
<h2 class="anchored" data-anchor-id="learning-rate-0.001">Learning rate = 0.001</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente</span>(<span class="fl">0.001</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">gradiente</span>(<span class="fl">0.001</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-05a3023b47179e998bde" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-05a3023b47179e998bde">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101"],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[0,-0.025,-0.04738993750000001,-0.06811988214357825,-0.08776065150393597,-0.1066858806725191,-0.1251558839850102,-0.1433610439507752,-0.16144621683963,-0.1795253589357912,-0.1976907404385529,-0.2160189884084728,-0.2345751834409496,-0.2534157143116702,-0.2725903131873093,-0.2921435342922993,-0.31211584469649,-0.3325444383530003,-0.3534638483140522,-0.3749064086635923,-0.3969026022344206,-0.4194813197260533,-0.4426700486444163,-0.4664950054468038,-0.4909812206956197,-0.5161525844480561,-0.5420318572362446,-0.5686406506227505,-0.5959993803134569,-0.6241271940808003,-0.6530418762309106,-0.6827597299943059,-0.7132954390010136,-0.7446619088965818,-0.7768700901513678,-0.8099287832023229,-0.8438444272378457,-0.8786208741875476,-0.9142591498060973,-0.9507572041396233,-0.9881096541293405,-1.026307521633147,-1.065337970722259,-1.105184048723511,-1.145824436111667,-1.187233210988348,-1.229379634488523,-1.272227964000413,-1.315737301534128,-1.359861484888395,-1.404549029400696,-1.44974312798083,-1.495381716779445,-1.541397613194743,-1.587718731943355,-1.634268383598584,-1.680965658329589,-1.727725895576598,-1.774461238109479,-1.821081266402858,-1.867493706606191,-1.91360520269853,-1.959322140818375,-2.004551511382441,-2.049201792588883,-2.093183837368256,-2.136411744909508,-2.178803697631389,-2.220282744939217,-2.260777516309005,-2.300222848137698,-2.338560311309232,-2.375738629432822,-2.411713981064147,-2.44645018275487,-2.479918753317328,-2.512098863071272,-2.542977174907664,-2.572547586636753,-2.600810886193887,-2.627774332803133,-2.653451178129463,-2.677860141802944,-2.701024855519842,-2.722973289285394,-2.74373717234555,-2.763351420052205,-2.7818535764112,-2.799283280462556,-2.815681763016657,-2.831091378685213,-2.845555176654626,-2.859116512291171,-2.871818700467973,-2.883704710477092,-2.894816901539991,-2.905196797251982,-2.91488489678039,-2.923920520267543,-2.932341685650939,-2.940185013985475],[5,4.65,4.387553375,4.18174101014169,4.01525460396803,3.877469234972862,3.761421876232104,3.662319578442617,3.576733995224207,3.502135845521817,3.436610974994593,3.378679437382366,3.327175955032961,3.281168474013968,3.239901195339553,3.202753807246048,3.16921172212966,3.138843960150871,3.111286454091056,3.086229267265117,3.063406681723573,3.042589422695751,3.023578494074579,3.006200243575698,2.99030237688253,2.975750711616939,2.96242651349084,2.950224294566394,2.939049981276017,2.928819380532151,2.919456887836824,2.910894393150475,2.90307034937152,2.895928975312451,2.889419570543359,2.883495923782719,2.87811579992414,2.873240493502719,2.868834438580758,2.864864866787372,2.861301506669706,2.858116318673838,2.855283261024125,2.852778082551986,2.850578139170858,2.848662231228476,2.847010459410214,2.845604097233466,2.844425478475002,2.843457898120567,2.842685525626268,2.842093329440925,2.841667011862424,2.841392953393901,2.841258165831161,2.841250253354785,2.841357380922791,2.841568249266063,2.841872075783069,2.842258580616742,2.842717977178882,2.843240966370397,2.843818733733151,2.844442948764925,2.84510576563638,2.845799824570449,2.846518253182004,2.84725466712967,2.848003169501706,2.848758348442598,2.849515272623606,2.850269484265811,2.851016989533902,2.851754246228917,2.852478148813787,2.853186010902907,2.853875545432394,2.854544842798489,2.855192347305857,2.855816832304466,2.856417374413341,2.85699332723276,2.857544294935075,2.858070106100455,2.858570788130051,2.859046542527995,2.859497721297982,2.859924804652362,2.860328380183851,2.860709123604041,2.861067781110199,2.861405153403441,2.861722081347929,2.862019433232538,2.862298093573553,2.862558953379156,2.862802901783455,2.86303081894904,2.86324357013207,2.863442000802087,2.863626932709569],[250,142.6448503906252,80.87983554136787,42.22473788066713,16.55557694913537,-1.264648733363231,-14.07503778861366,-23.54954033399011,-30.72665175111493,-36.27774658497873,-40.65193988020971,-44.15845999631837,-47.01556081267039,-49.38065096501927,-51.36944763378058,-53.06849138424266,-54.5435222766381,-55.84520651649939,-57.01312659414711,-58.07860903285662,-59.06675912152355,-59.99794520658514,-60.88889482564639,-61.75351308877983,-62.60349957520165,-63.44881716674801,-64.29805071211462,-65.15868271135113,-66.03730573324607,-66.93978599274905,-67.8713887383791,-68.83687337427551,-69.84056425946179,-70.88640167685502,-71.97797640068009,-73.11855051153815,-74.31106654193252,-75.55814663090453,-76.86208308829583,-78.22482159071471,-79.64793813299457,-81.13261082574707,-82.67958764925336,-84.2891513356243,-85.96108264458675,-87.69462341285373,-89.48844088141311,-91.34059492669752,-93.24850992669083,-95.20895306671814,-97.21802091643247,-99.27113607392062,-101.3630555605733,-103.4878924494743,-105.6391519124916,-107.8097824743244,-109.9922427695866,-112.1785835236566,-114.3605438400407,-116.529660205327,-118.6773859537445,-120.7952183085312,-122.8748295808581,-124.908198701839,-126.8877390267712,-128.8064183114373,-130.6578669333879,-132.4364708165568,-134.1374460987721,-135.7568933263427,-137.2918298220638,-138.7401997972885,-140.1008627051956,-141.3735612020096,-142.5588708429138,-143.6581342476948,-144.6733828996201,-145.6072499769548,-146.4628776624346,-147.2438222480436,-147.9539600774702,-148.5973969806255,-149.178383391009,-149.7012368346863,-150.1702729733138,-150.5897459017468,-150.963797965507,-151.2964189898868,-151.5914145090747,-151.8523823527274,-152.0826967863354,-152.2854993043454,-152.4636951327367,-152.6199545008365,-152.7567177804891,-152.8762036546484,-152.9804195583266,-153.0711737251427,-153.1500882663886,-153.218612801822,-153.278038248873]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
</section>
<section id="learning-rate-0.0001" class="level2">
<h2 class="anchored" data-anchor-id="learning-rate-0.0001">Learning rate = 0.0001</h2>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente</span>(<span class="fl">0.0001</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">gradiente</span>(<span class="fl">0.0001</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-78d589473ba0b04a1596" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-78d589473ba0b04a1596">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101"],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[0,-0.0025,-0.00497263999375,-0.00741904362182962,-0.009840278313840203,-0.01223735898546134,-0.01461125143776487,-0.01696287548707079,-0.01929310785054412,-0.02160278481002542,-0.02389270467420831,-0.02616363005718154,-0.02841628998950329,-0.03065138187633959,-0.03286957331574902,-0.03507150378890962,-0.03725778623293977,-0.03942900850594619,-0.04158573475302282,-0.04372850668111232,-0.04585784474991483,-0.04797424928537701,-0.05007820152170922,-0.05217016457735307,-0.05425058436984788,-0.05631989047411799,-0.05837849692831746,-0.0604268029910206,-0.06246519385323163,-0.06449404130840115,-0.06651370438337831,-0.06852452993299182,-0.07052685320073981,-0.07252099834787286,-0.0745072789529779,-0.07648599848400832,-0.0784574507445578,-0.08042192029604053,-0.08237968285731648,-0.08433100568318724,-0.08627614792308426,-0.08821536096117558,-0.09014888873903024,-0.09207696806189845,-0.09399982888959199,-0.09591769461288088,-0.09783078231625977,-0.09973930302787916,-0.1016434619573833,-0.1035434587223474,-0.1054394875639599,-0.1073317375525558,-0.1092203927835639,-0.1111056325643991,-0.1129876315927926,-0.114866560127027,-0.1167425841485075,-0.1186158655170798,-0.1204865621194778,-0.1223548280112578,-0.1242208135525604,-0.1260846655380161,-0.1279465273210927,-0.1298065389331672,-0.1316648371975858,-0.1335215558389625,-0.1353768255879491,-0.1372307742817016,-0.1390835269602489,-0.1409352059589635,-0.1427859309973192,-0.1446358192641125,-0.1464849854993144,-0.1483335420727091,-0.1501815990594696,-0.1520292643128102,-0.1538766435338502,-0.1557238403388141,-0.1575709563236893,-0.1594180911264539,-0.1612653424869824,-0.1631128063047327,-0.1649605766943089,-0.1668087460389945,-0.1686574050423416,-0.1705066427779007,-0.1723565467371689,-0.1742072028758312,-0.176058695658369,-0.1779111081010998,-0.1797645218137161,-0.1816190170393839,-0.1834746726934588,-0.1853315664008763,-0.1871897745322701,-0.1890493722388683,-0.1909104334862159,-0.1927730310867704,-0.1946372367314148,-0.1965031210199288,-0.1983707534904601],[5,4.965,4.930940149025,4.897781182654386,4.865486087690184,4.834019938788752,4.803349749368468,4.773444335340391,4.74427419037709,4.715811371581268,4.688029394543605,4.660903136891012,4.634408749524403,4.608523574831147,4.583226071232973,4.558495743496882,4.534313078295498,4.510659484555457,4.487517238178619,4.464869430761967,4.442699921978474,4.42099329531383,4.39973481688281,4.378910397075077,4.358506554803348,4.338510384147647,4.318909523208036,4.299692124994954,4.280846830201401,4.26236274171477,4.24422940073841,4.226436764404076,4.208975184766427,4.191835389079825,4.175008461265879,4.158485824487684,4.142259224753432,4.12632071547829,4.110662642939011,4.095277632560901,4.080158575981389,4.065298618838755,4.050691149238441,4.036329786852935,4.022208372614508,4.008320958963046,3.994661800613991,3.981225345813915,3.968006228053572,3.954999258210407,3.942199417094448,3.929601848373361,3.91720185185404,3.90499487709973,3.892976517363025,3.881142503816446,3.869488700063499,3.858011096914236,3.846705807410391,3.835569062086115,3.824597204451249,3.813786686684876,3.803134065527694,3.792635998362446,3.782289239472314,3.772090636467815,3.762037126873299,3.752125734864697,3.742353568150656,3.732717814989685,3.723215741336345,3.713844688109949,3.704602068579603,3.695485365859775,3.686492130510914,3.677619978239963,3.668866587695869,3.660229698355512,3.651707108495682,3.64329667324701,3.634996302725966,3.626803960241252,3.618717660571104,3.610735468308236,3.60285549626929,3.595075903965855,3.587394896134255,3.579810721321457,3.572321670524584,3.564926075881655,3.557622309411279,3.550408781799165,3.543283941229402,3.536246272258576,3.529294294730874,3.522426562732429,3.515641663583244,3.508938216865102,3.502314873483958,3.495770314765384,3.489303251581688],[250,237.8527969694142,226.345059887837,215.4339335423405,205.0800552647644,195.2472203253694,185.9020840685071,177.013896254192,168.5542636897738,160.4969377633703,152.817623940395,145.4938106688567,138.5046154683828,131.8306462607173,125.4538762428477,119.3575308139094,113.5259852485624,107.9446719668049,102.5999963867391,97.47926046556046,92.57059313754712,87.86288694820598,83.34574026276994,79.00940449652762,74.84473587525633,70.84315128749904,66.99658783750903,63.29746574921603,59.73865430826095,56.31344056161413,53.01550052305436,49.83887265832192,46.77793344643834,43.82737483387592,40.98218341624738,38.23762119823374,35.5892077968096,33.03270396564568,30.56409633005859,28.1795832321755,25.87556159522254,23.64861472416399,21.49550096738793,19.41314317086901,17.39861886231611,15.44915110828831,13.56209999221886,11.73495466576321,9.965325929947625,8.250939306266247,6.589628561211072,4.979329650747616,3.41807505399845,1.903988467902252,0.4352798368924198,-0.9897593062817975,-2.372760210577468,-3.715281007778742,-5.018810563392378,-6.284772094553404,-7.514526570851046,-8.709375912778796,-9.870566001404057,-10.99928951183344,-12.0966885821212,-13.163857328408,-14.20184421629207,-15.2116542977096,-16.19425132193567,-17.15055972870218,-18.08146653086513,-18.98782309353015,-19.87044681606611,-20.73012272299044,-21.56760496929988,-22.38361826544153,-23.17885922676646,-23.95399765198459,-24.7096777348375,-25.44651921292845,-26.16511845738739,-26.86604950681308,-27.54986504870723,-28.21709735141226,-28.86825914937029,-29.50384448434281,-30.12432950506442,-30.73017322764929,-31.321818258924,-31.89969148472869,-32.46420472510076,-33.01575535813976,-33.55472691424416,-34.08148964230764,-34.59640104936909,-35.09980641512067,-35.59203928259635,-36.07342192628599,-36.54426579884665,-37.0048719575158,-37.45553147126776]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
<p>Nota-se pelos resultados que para valores de <em>learning rate</em> <span class="math inline">\(\epsilon = (1;0,1)\)</span> a função divergiu. Para valores <span class="math inline">\(\epsilon = (0,001; 0,0001)\)</span> a função iterou até o limite de 100 iterações fixadas, e não chegou a um mínimo segundo o critério de parada definido, sendo que para <span class="math inline">\(\epsilon = 0,0001\)</span> o valor da função de perda ainda estava bem longe do valor alvo. Por outro lado, para <span class="math inline">\(\epsilon = 0,01\)</span>, a função chegou a um mínimo segundo o critério de parada definido, e o fez em poucas iterações, ativando a cláusula de parada por convergência numérica.</p>
<p>Desta forma, o valor <span class="math inline">\(\epsilon = 0,01\)</span> parece ser o mais coerente dentre as opções apresentadas.</p>
</section>
</section>
<section id="f" class="level1">
<h1>f)</h1>
<p>Fixe a semente do gerador de números aleatórios no valor 42 (se estiver usando o <strong>R</strong>, basta executar o código <code>set.seed(42)</code>). Repita novamente o item d), agora partindo de 10 pontos escolhidos aleatoriamente (Uniformemente) no quadrado <span class="math inline">\(-5 &lt; x_1, x_2 &lt; 5\)</span>. Refaça o gráfico do item a) e adicione uma linha representando o caminho percorrido por cada uma das 10 otimizações. Qual foi o percentual de vezes em que o algoritmo encontrou o mínimo global da função (despresando um eventual desvio de menor importância)?</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>pontos <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>trajetorias <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  resultado <span class="ot">&lt;-</span> <span class="fu">gradiente</span>(<span class="at">learning_rate =</span> <span class="fl">0.01</span>, <span class="at">n_steps =</span> <span class="dv">100</span>, <span class="at">x1 =</span> pontos[i], <span class="at">x2 =</span> pontos[i<span class="sc">+</span><span class="dv">10</span>])[[<span class="dv">2</span>]]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  trajetorias[[i]] <span class="ot">&lt;-</span> resultado</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>traj_all <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">Map</span>(<span class="cf">function</span>(df, id) {</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>traj_id <span class="ot">&lt;-</span> id</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>}, trajetorias, <span class="fu">seq_along</span>(trajetorias)))</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> fx)) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> traj_all, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">group =</span> traj_id, <span class="at">color =</span> <span class="fu">as.factor</span>(traj_id)), <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Analisando o gráfico, nota-se que em apenas uma das tentativas, o algoritmo convergiu para o mínimo global aparente. Todas as outras tentativas convergiram, porém para um dos três mínimos locais aparentes.</p>
<p>Este resultado concide com o discutido em sala de aula, isto é, o método do gradiente descendente é eficaz em buscar mínimos de função, porém na sua forma mais simples de implementação, ele é incapaz de escapar de um mínimo local, visto que irá tomar uma trajetória descendente sempre que encontrar um mínimo próximo do ponto em que está. Sabe-se que em funções estritamente convexas, o gradiente descendente irá encontrar o mínimo global. Entretanto, funções com mínimos locais e pontos de sela podem atrapalhar a convergência do algoritmo. Neste caso, uma das possíveis soluções discutidas e aqui implementadas é justamente testar vários pontos iniciais, na esperança que algum ou alguns deles iniciem-se próximos ao mínimo global da função. Neste caso bidimensional, a figura ajuda bastante a identificação dos mínimos e as convergências, entretanto num caso multidimensional, bastaria avaliar o valor da função para identificação do mínimo global, ou ao menos um mínimo local bom o suficiente.</p>
</section>
<section id="g" class="level1">
<h1>g)</h1>
<p>Repita o item d), substituindo o método do gradiente pelo método do gradiente com momento (veja a Seção 8.3.2 do livro Deep Learning). Use taxa de aprendizado <span class="math inline">\(\epsilon = 0.01\)</span>, parâmetro de momento <span class="math inline">\(\alpha = 0.9\)</span> e velocidade inicial v = 0.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gradiente_momento <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, learning_rate, n_steps, x1, x2) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="fu">numeric</span>(),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">numeric</span>())</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  init <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="dv">0</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> x1,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> x2,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">fx</span>(x1,x2))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,init)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_steps){</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    dpx1 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x1 <span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x2 <span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">40</span> <span class="sc">*</span> x1)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    dpx2 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x2 <span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x1 <span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">30</span> <span class="sc">*</span> x2)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    v1 <span class="ot">&lt;-</span> alpha <span class="sc">*</span> v1 <span class="sc">-</span> learning_rate <span class="sc">*</span> dpx1</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    v2 <span class="ot">&lt;-</span> alpha <span class="sc">*</span> v2 <span class="sc">-</span> learning_rate <span class="sc">*</span> dpx2</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x1 <span class="sc">+</span> v1</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> x2 <span class="sc">+</span> v2</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    fx <span class="ot">&lt;-</span> <span class="fu">fx</span>(x1,x2)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.finite</span>(fx) <span class="sc">||</span> <span class="fu">abs</span>(fx <span class="sc">-</span> df<span class="sc">$</span>fx[i]) <span class="sc">&lt;</span> <span class="fl">10e-6</span> <span class="sc">+</span> <span class="fu">mean</span>(v1,v2)){</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> i,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> x1,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> x2,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">fx</span>(x1,x2))</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,result)</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> fx)) <span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2), <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente_momento</span>(.<span class="dv">9</span>,.<span class="dv">01</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pela Figura acima, nota-se que adicionando o componente de momento ao algoritmo de gradiente descendente, os passos da função de tornam muito mais erráticos, permitindo que a função passeie pelo espaço paramétrico por mais tempo, e impedindo o gradiente de descer nos primeiros vales que percorre. É possível observar que a função passou por todos os quatro vales de mínimos, até convergir em um dos mínimos locais.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente_momento</span>(.<span class="dv">9</span>,.<span class="dv">01</span>,<span class="dv">100</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Observando a Figura acima, nota-se que mudando o ponto de partida, o algoritmo conseguiu cumprir o seu propósito, isto é, escapar de um mínimo local e direcionar para o aparente mínimo global da função de perda.</p>
<p>Desta forma, pode-se dizer que adicionar o conceito de momento pode ser útil para impedir o gradiente de estacionar em mínimos locais, entretanto isto ainda não é garantindo, dependendo ainda bastante do ponto inicial escolhido.</p>
</section>
<section id="h" class="level1">
<h1>h)</h1>
<p>Repita o item d), substituindo o método do gradiente pelo método RMSProp (veja a Seção 8.5.2 do livro Deep Learning). Use taxa de aprendizado <span class="math inline">\(\epsilon = 0.001\)</span>, taxa de decaimento <span class="math inline">\(\rho = 0.9\)</span> e constante <span class="math inline">\(\delta = 10^{-6}\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gradiente_rmsprop <span class="ot">&lt;-</span> <span class="cf">function</span>(learning_rate, n_steps, x1, x2, rho, epsilon) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="fu">numeric</span>(),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">numeric</span>())</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  init <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="dv">0</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> x1,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> x2,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">fx</span>(x1,x2))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,init)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_steps){</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    dpx1 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x1 <span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x2 <span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">40</span> <span class="sc">*</span> x1)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    dpx2 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x2 <span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x1 <span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">30</span> <span class="sc">*</span> x2)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    v1 <span class="ot">&lt;-</span> rho <span class="sc">*</span> v1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho) <span class="sc">*</span> dpx1<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    v2 <span class="ot">&lt;-</span> rho <span class="sc">*</span> v2 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho) <span class="sc">*</span> dpx2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x1 <span class="sc">-</span> (learning_rate <span class="sc">/</span> <span class="fu">sqrt</span>(v1 <span class="sc">+</span> epsilon)) <span class="sc">*</span> dpx1</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> x2 <span class="sc">-</span> (learning_rate <span class="sc">/</span> <span class="fu">sqrt</span>(v2 <span class="sc">+</span> epsilon)) <span class="sc">*</span> dpx2</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    fx <span class="ot">&lt;-</span> <span class="fu">fx</span>(x1,x2)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.finite</span>(fx) <span class="sc">||</span> <span class="fu">abs</span>(fx <span class="sc">-</span> df<span class="sc">$</span>fx[i]) <span class="sc">&lt;</span> <span class="fl">10e-6</span>){</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> i,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> x1,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> x2,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">fx</span>(x1,x2))</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,result)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> fx)) <span class="sc">+</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2), <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(p,df))</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>resultadosp <span class="ot">&lt;-</span> <span class="fu">gradiente_rmsprop</span>(.<span class="dv">001</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">9</span>,<span class="fl">10e-6</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>resultadosp[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(resultadosp[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-00a003eef0ffec5df42c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-00a003eef0ffec5df42c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101"],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[0,-0.003162277407186197,-0.005459179632462762,-0.00738380039702788,-0.009093205403430667,-0.01066037730219342,-0.01212601400996645,-0.01351544196048426,-0.01484562691560377,-0.0161285519453085,-0.01737302493118921,-0.01858572388897466,-0.01977183895810367,-0.02093548606664608,-0.0220799841500701,-0.02320804711756782,-0.02432192052772309,-0.02542348124907877,-0.02651431165324895,-0.02759575586290594,-0.02866896308696155,-0.02973492148935789,-0.03079448500144437,-0.03184839479486724,-0.03289729665885351,-0.03394175519686615,-0.03498226552505779,-0.03601926298800159,-0.03705313128564194,-0.03808420931579045,-0.03911279696962666,-0.04013916006722386,-0.04116353458168395,-0.04218613027089631,-0.04320713381298549,-0.04422671152355082,-0.04524501171863216,-0.0462621667760757,-0.04727829493896172,-0.04829350189749528,-0.04930788217987233,-0.05032152037783023,-0.05133449222864922,-0.05234686557211825,-0.05335870119827919,-0.05437005359951265,-0.05538097163864221,-0.05639149914314537,-0.05740167543421625,-0.05841153579828386,-0.0594211119076166,-0.06043043219581015,-0.06143952219324014,-0.06244840482694322,-0.06345710068885588,-0.06446562827587694,-0.06547400420481603,-0.066482243404938,-0.06749035929050549,-0.06849836391545155,-0.06950626811207646,-0.07051408161545443,-0.07152181317505082,-0.07252947065488775,-0.07353706112345156,-0.07454459093440778,-0.07555206579907563,-0.07655949085151306,-0.07756687070697386,-0.07857420951441801,-0.07958151100368559,-0.08058877852788061,-0.08159601510145474,-0.08260322343442963,-0.08361040596315193,-0.08461756487793372,-0.08562470214789553,-0.08663181954329602,-0.08763891865560368,-0.08864600091553949,-0.08965306760929642,-0.09066011989312038,-0.09166715880641865,-0.09267418528354475,-0.09368120016439366,-0.09468820420392772,-0.09569519808074133,-0.09670218240476147,-0.09770915772417152,-0.09871612453163657,-0.09972308326990101,-0.1007300343368216,-0.1017369780898931,-0.1027439148503174,-0.1037508449066627,-0.1047577685181537,-0.10576468591763,-0.1067715973142064,-0.1077785028956651,-0.1087854028306067,-0.1097922972703845],[5,4.996837722341122,4.994546317710841,4.992629052178031,4.990927996829203,4.989369832578576,4.987913694855195,4.98653416150525,4.98521420577394,4.983941802538739,4.982708113043461,4.981506435407144,4.980331560240097,4.979179355529234,4.978046488503725,4.976930233070407,4.975828332736106,4.974738900670665,4.973660345320064,4.972591314020375,4.971530649562778,4.970477356251665,4.969430573038037,4.968389552005828,4.967353640963499,4.966322269223203,4.965294935883153,4.96427120009632,4.963250672930464,4.962233010514439,4.961217908232767,4.960205095781046,4.959194332933334,4.958185405902293,4.957178124195863,4.956172317892309,4.955167835269605,4.954164540736471,4.95316231302139,4.952161043583179,4.951160635212636,4.95016100079955,4.949162062243336,4.948163749488793,4.947165999671198,4.946168756357197,4.945171968869817,4.944175591687559,4.943179583908803,4.942183908773976,4.941188533238833,4.940193427593076,4.939198565119237,4.938203921787355,4.937209475981543,4.936215208254954,4.935221101110097,4.934227138801798,4.933233307160383,4.932239593432959,4.931245986140892,4.930252474951788,4.92925905056447,4.928265704605609,4.927272429536803,4.926279218571037,4.925286065597558,4.924292965114311,4.923299912167155,4.922306902295199,4.921313931481595,4.920320996109273,4.919328092921107,4.918335218984057,4.917342371656893,4.916349548561155,4.915356747554993,4.91436396670963,4.913371204288168,4.912378458726502,4.911385728616137,4.910393012688727,4.909400309802131,4.908407618927881,4.907414939139877,4.906422269604222,4.905429609570056,4.904436958361309,4.903444315369273,4.902451680045908,4.901459051897817,4.900466430480821,4.899473815395072,4.898481206280644,4.897488602813579,4.896496004702305,4.895503411684429,4.894510823523837,4.893518240008082,4.892525660946039,4.891533086165786],[250,248.815445188727,247.9585940852097,247.2426255620151,246.6081476452118,246.0275891819875,245.4855846504965,244.9725761475536,244.4821631060489,244.0098259428692,243.5522433567099,243.1068976230167,242.6718322447753,242.2454958291807,241.8266374815996,241.4142343819445,241.0074402296509,240.6055476574084,240.2079602545169,239.8141713606256,239.4237477306494,239.0363167703247,238.6515564330459,238.2691871301985,237.888965185708,237.5106774896473,237.1341370934808,236.7591795525232,236.3856598670334,236.0134499071863,235.6424362323839,235.2725182343887,234.9036065482798,234.5356216863648,234.1684928588497,233.8021569518444,233.4365576386142,233.071644604247,232.7073728672964,232.3437021846952,231.9805965284676,231.6180236245587,231.2559545456032,230.8943633506711,230.5332267660425,230.1725239019266,229.8122360007243,229.4523462130567,229.0928393982726,228.7337019465796,228.3749216203113,228.0164874121552,227.6583894184358,227.3006187257731,226.9431673096505,226.5860279435846,226.2291941177486,225.8726599660395,225.5164202006758,225.1604700535366,224.8048052235235,224.4494218293159,224.0943163669541,223.7394856717505,223.3849268840742,223.0306374186165,222.6766149367717,222.3228573218163,221.9693626566017,221.6161292034986,221.2631553863681,220.9104397743506,220.5579810672891,220.2057780826187,219.8538297435779,219.502135068603,219.1506931617912,218.7995032043189,218.448564446724,218.0978762019623,217.7474378391589,217.3972487779899,217.0473084836246,216.6976164621749,216.3481722566024,215.9989754430337,215.6500256274475,215.3013224426904,214.9528655457933,214.604654615556,214.2566893503748,213.9089694662861,213.5614946952063,213.2142647833481,212.8672794897947,212.520538585218,212.1740418507235,211.8277890768118,211.4817800624433,211.1360146141974,210.7904925455153]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
<p>Pelo gráfico acima, nota-se que o algoritmo aparenta estar caminhando para um mínimo local. Entretanto, a taxa de aprendizagem baixa e um número reduzido de passos impede de localizar o mínimo local. Ajustando a taxa de aprendizagem para <span class="math inline">\(\epsilon = 0.1\)</span>, podemos observar visualmente o caminhar do algoritmo ao mínimo local mais próximo do ponto inicial.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>resultadosp <span class="ot">&lt;-</span> <span class="fu">gradiente_rmsprop</span>(.<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">9</span>,<span class="fl">10e-6</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>resultadosp[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="i" class="level1">
<h1>i)</h1>
<p>Repita o item d), substituindo o método do gradiente pelo método ADAM (veja a Seção 8.5.3 do livro Deep Learning). Use taxa de aprendizado <span class="math inline">\(\epsilon = 0.001\)</span> e taxas de decaimento <span class="math inline">\(\rho_1 = 0.9\)</span> e <span class="math inline">\(\rho_2 = 0.999\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gradiente_adam <span class="ot">&lt;-</span> <span class="cf">function</span>(learning_rate, n_steps, x1, x2, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                           rho1, rho2, delta) {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x2 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fx =</span> <span class="fu">numeric</span>())</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  init <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> <span class="dv">0</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x1 =</span> x1,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2 =</span> x2,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fx =</span> <span class="fu">fx</span>(x1, x2))</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, init)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_steps) {</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    g1 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x1 <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x2 <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">40</span> <span class="sc">*</span> x1)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    g2 <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> x2 <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">+</span> (x1 <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">30</span> <span class="sc">*</span> x2)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    s1 <span class="ot">&lt;-</span> rho1 <span class="sc">*</span> s1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho1) <span class="sc">*</span> g1</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    s2 <span class="ot">&lt;-</span> rho1 <span class="sc">*</span> s2 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho1) <span class="sc">*</span> g2</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    r1 <span class="ot">&lt;-</span> rho2 <span class="sc">*</span> r1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho2) <span class="sc">*</span> g1<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    r2 <span class="ot">&lt;-</span> rho2 <span class="sc">*</span> r2 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho2) <span class="sc">*</span> g2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    s1_hat <span class="ot">&lt;-</span> s1 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> rho1<span class="sc">^</span>i)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    s2_hat <span class="ot">&lt;-</span> s2 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> rho1<span class="sc">^</span>i)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    r1_hat <span class="ot">&lt;-</span> r1 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> rho2<span class="sc">^</span>i)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    r2_hat <span class="ot">&lt;-</span> r2 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> rho2<span class="sc">^</span>i)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x1 <span class="sc">-</span> (learning_rate <span class="sc">/</span> (<span class="fu">sqrt</span>(r1_hat) <span class="sc">+</span> delta)) <span class="sc">*</span> s1_hat</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> x2 <span class="sc">-</span> (learning_rate <span class="sc">/</span> (<span class="fu">sqrt</span>(r2_hat) <span class="sc">+</span> delta)) <span class="sc">*</span> s2_hat</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    fx_val <span class="ot">&lt;-</span> <span class="fu">fx</span>(x1, x2)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(fx_val) <span class="sc">||</span> <span class="fu">abs</span>(fx_val <span class="sc">-</span> df<span class="sc">$</span>fx[i]) <span class="sc">&lt;</span> <span class="fl">10e-6</span>) {</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">step =</span> i,</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x1 =</span> x1,</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x2 =</span> x2,</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fx =</span> fx_val)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, result)</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour_filled</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> fx)) <span class="sc">+</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2), <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(p, df))</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente_adam</span>(.<span class="dv">001</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">9</span>,.<span class="dv">999</span>,<span class="fl">10e-8</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details>
<summary>Ver tabela</summary>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">gradiente_adam</span>(.<span class="dv">001</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">9</span>,.<span class="dv">999</span>,<span class="fl">10e-8</span>)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f6ffd11753f0bbc62873" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f6ffd11753f0bbc62873">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101"],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[0,-0.000999999996,-0.002000020759350697,-0.003000076070655416,-0.004000179624914355,-0.005000345002347629,-0.006000585640085054,-0.007000914804931527,-0.008001345567400751,-0.009001890777191494,-0.01000256304026009,-0.01100337469762042,-0.01200433780597913,-0.01300546412028989,-0.01400676507828585,-0.01500825178702569,-0.01600993501146528,-0.01701182516504463,-0.01801393230225929,-0.01901626611316633,-0.02001883591975774,-0.0210216506741196,-0.02202471895828234,-0.02302804898565702,-0.0240316486039445,-0.02503552529939813,-0.02603968620231674,-0.02704413809364288,-0.02804888741254066,-0.02905394026482924,-0.03005930243215091,-0.03106497938175631,-0.0320709762767949,-0.03307729798700442,-0.03408394909969957,-0.03509093393096736,-0.03609825653698377,-0.03710592072537373,-0.03811393006654441,-0.0391222879049285,-0.0401309973700823,-0.04114006138758981,-0.04214948268973107,-0.04315926382587921,-0.04416940717259671,-0.04517991494340694,-0.04619078919822191,-0.04720203185241217,-0.04821364468550874,-0.04922562934953074,-0.05023798737693608,-0.05125072018819495,-0.05226382909898911,-0.05327731532704161,-0.05429117999858393,-0.05530542415446871,-0.05632004875593805,-0.05733505469005784,-0.05835044277483003,-0.05936621376399472,-0.06038236835153507,-0.06139890717589772,-0.06241583082394196,-0.06343313983463079,-0.06445083470247677,-0.06546891588075562,-0.06648738378450031,-0.06750623879328765,-0.06852548125382979,-0.06954511148238174,-0.07056512976697649,-0.0715855363694981,-0.07260633152760335,-0.07362751545650133,-0.07464908835060077,-0.07567105038503356,-0.07669340171706304,-0.07771614248738493,-0.07873927282132846,-0.07976279282996468,-0.08078670261112848,-0.08181100225036085,-0.0828356918217768,-0.0838607713888648,-0.08488624100522253,-0.08591210071523392,-0.08693835055469178,-0.0879649905513703,-0.08899202072555115,-0.09001944109050683,-0.09104725165294458,-0.09207545241341396,-0.09310404336668095,-0.0941330245020712,-0.09516239580378495,-0.09619215725118581,-0.09722230881906556,-0.09825285047788695,-0.09928378219400617,-0.1003151039298767,-0.1013468156442363],[5,4.999000000000286,4.998000020936782,4.9970000767242,4.996000181206131,4.995000348124456,4.994000591089577,4.993000923551665,4.992001358773164,4.991001909802722,4.990002589450707,4.989003410266479,4.988004384517506,4.987005524170449,4.986006840874264,4.985008345945381,4.984010050354971,4.983011964718306,4.982014099286183,4.981016463938369,4.980019068179004,4.979021921133885,4.97802503154953,4.977028407793931,4.97603205785887,4.975035989363682,4.974040209560344,4.97304472533975,4.972049543239057,4.971054669449961,4.970060109827788,4.969065869901268,4.96807195488288,4.967078369679659,4.966085118904351,4.965092206886825,4.964099637685653,4.963107415099762,4.962115542680105,4.961124023741255,4.960132861372887,4.959142058451079,4.958151617649396,4.957161541449712,4.956171832152731,4.955182491888201,4.954193522624771,4.9532049261795,4.952216704226986,4.951228858308121,4.950241389838456,4.949254300116182,4.94826759032973,4.947281261564983,4.946295314812117,4.945309750972076,4.944324570862688,4.943339775224428,4.942355364725855,4.941371339968716,4.940387701492745,4.939404449780154,4.938421585259851,4.937439108311379,4.936457019268595,4.935475318423111,4.934494006027495,4.933513082298254,4.932532547418618,4.931552401541116,4.930572644789978,4.929593277263361,4.928614299035416,4.927635710158196,4.926657510663436,4.925679700564189,4.924702279856342,4.92372524852002,4.922748606520877,4.921772353811297,4.920796490331491,4.919821016010516,4.918845930767212,4.917871234511062,4.916896927142989,4.915923008556088,4.914949478636292,4.913976337262998,4.913003584309628,4.912031219644153,4.911059243129575,4.910087654624359,4.909116453982844,4.908145641055608,4.907175215689806,4.906205177729486,4.905235527015869,4.904266263387608,4.903297386681034,4.902328896730366,4.901360793367915],[250,249.625129978202,249.2505266203722,248.8761942888954,248.5021373068917,248.1283599484123,247.7548664289503,247.3816608963377,247.0087474220949,246.636129993289,246.2638125049519,245.8917987531029,245.520092428409,245.1486971105123,244.7776162630411,244.4068532293164,244.0364112287555,243.6662933539673,243.2965025685309,242.9270417054333,242.5579134661465,242.1891204203117,241.8206650059996,241.4525495305101,241.0847761716669,240.7173469795727,240.3502638787759,239.9835286708085,239.6171430370508,239.251108541882,238.8854266360684,238.5200986603593,238.1551258492426,237.7905093348272,237.4262501508197,237.0623492365622,236.6988074410989,236.3356255272519,235.9728041756753,235.610343988871,235.2482454951457,234.88650915249,234.5251353523719,234.164124423428,233.8034766350411,233.4431922008031,233.083271281849,232.723713990064,232.3645203911573,232.0056905076004,231.6472243214305,231.2891217769196,230.9313827831097,230.5740072162164,230.2169949219024,229.860345717428,229.504059393674,229.148135717053,228.7925744313011,228.437375259162,228.0825379039662,227.7280620511091,227.3739473694338,227.0201935125231,226.6668001199029,226.3137668181662,225.9610932220206,225.6087789352575,225.2568235516601,224.90522665584,224.5539878240172,224.2031066247424,223.8525826195645,223.5024153636503,223.1526044063568,222.80314929176,222.454049559144,222.1053047434505,221.7569143756974,221.4088779833586,221.061195090721,220.7138652192077,220.3668878876777,220.0202626127019,219.6739889088154,219.3280662887506,218.9824942636517,218.6372723432687,218.2924000361403,217.9478768497559,217.6037022907093,217.2598758648363,216.9163970773428,216.5732654329185,216.2304804358466,215.8880415900996,215.545948399428,215.2042003674425,214.8627969976881,214.5217377937122,214.1810222591261]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>step<\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>fx<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"step","targets":1},{"name":"x1","targets":2},{"name":"x2","targets":3},{"name":"fx","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</details>
<p>Análogo ao item anterior, o learning rate <span class="math inline">\(\epsilon = 0.001\)</span> é muito baixo para o algoritmo encontrar o mínimo local no número de passos fornecidos (100). Ajustando o learning rate para <span class="math inline">\(\epsilon = 0.1\)</span>, mantido os demais hiperparâmetros constantes, pode-se observar na Figura abaixo a convergência do algoritmo para o mínimo local mais próximo do ponto inicial.</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradiente_adam</span>(.<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">9</span>,.<span class="dv">999</span>,<span class="fl">10e-8</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="j" class="level1">
<h1>j)</h1>
<p>Apresente graficamente, em uma única figura, os caminhos percorridos pelas otimizações executadas nos itens d), g), h) e i).</p>
<div class="cell">
<details class="code-fold">
<summary>Mostrar códigos</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">gradiente</span>(<span class="fl">0.01</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gradiente Descendente"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">gradiente_momento</span>(.<span class="dv">9</span>,.<span class="dv">01</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Momento"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">gradiente_rmsprop</span>(.<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">9</span>,<span class="fl">10e-6</span>)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"RMSProp"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">gradiente_adam</span>(.<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">9</span>,.<span class="dv">999</span>,<span class="fl">10e-8</span>)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Adam"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lista1_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pela Figura acima, nota-se que todos os algoritmos são eficazes em encontrar um ponto de mínimo, ainda que local. Nenhum deles conseguiu eliminar a necessidade de um bom ponto inicial para encontrar o mínimo global da função. Entretanto, como discutido em sala, não faz parte do paradigma de redes neurais artificiais no estado da arte atual a necessidade do mínimo global da função. Desta forma, estaremos mais preocupados com algoritmos que funcionem bem, e funcionem rápido, na busca pela convergência em algum ponto de mínimo aceitável. Neste sentido, todos foram eficientes, entretanto é possível notar que o gradiente na forma elementar pode ter problemas com pontos de sela e mínimos ruins, enquanto o método do momento pode ser muito errádico. Os métodos RMSProp e Adam aparentam ser mais estáveis, de rápida convergência para um mínimo aceitável e caminhar pouco errático.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>